(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{35:function(e,t,n){"use strict";t.__esModule=!0,function(e){e.t2000="8pm",e.t2030="8.30pm",e.t2100="9pm",e.t2130="9.30pm"}(t.TimeOption||(t.TimeOption={})),t.userFriendlyName=function(e){return e.surname&&e.useSurname?e.username+" "+e.surname:e.surname&&e.surname.length?e.username+" "+e.surname.charAt(0):e.username}},38:function(e,t,n){e.exports=n(83)},79:function(e,t,n){},81:function(e,t,n){},83:function(e,t,n){"use strict";n.r(t);var r,a,i,o,s,l,u,c=n(0),p=n(19),m=n(13),h=n(23),d=n(1),f=n(2),y=n(15),b=(n(43),n(6)),v=(r=function(){function e(){Object(d.a)(this,e),Object(h.a)(this,"error",a,this),Object(h.a)(this,"errorText",i,this),Object(h.a)(this,"busy",o,this),Object(h.a)(this,"verified",s,this)}return Object(f.a)(e,[{key:"request",value:function(t,n,r,a){var i=this;return this.busy=!0,e.doFetch(t,n,r).then(function(e){return i.busy=!1,a[e.status]?a[e.status](e):200==e.status?e.json():e.json().then(function(e){return i.setError(e.message)})}).catch(function(e){return i.busy=!1,i.setError(e.message)})}},{key:"post",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("POST",e,t,n)}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("GET",e,{},t)}},{key:"setError",value:function(e){return this.error=!0,this.errorText=e,Promise.reject(e)}},{key:"clearError",value:function(){this.error=!1,this.errorText=""}},{key:"storeOption",value:function(e){var t=this;return this.post("storeOption",{key:this.verified.profile.verificationKey,option:e}).then(function(e){t.verified.profile=e})}},{key:"storeTimeOption",value:function(e){var t=this;return this.post("storeTimeOption",{key:this.verified.profile.verificationKey,time:e}).then(function(e){t.verified.profile=e})}},{key:"storeHoliday",value:function(e){var t=this;return this.post("storeHoliday",{key:this.verified.profile.verificationKey,holiday:e}).then(function(e){t.verified.profile=e})}},{key:"storeFriends",value:function(e){var t=this;return this.post("storeFriends",{key:this.verified.profile.verificationKey,friends:e}).then(function(e){t.verified.profile=e})}},{key:"storeUserDetails",value:function(e,t){var n=this;return this.post("storeUserDetails",{key:this.verified.profile.verificationKey,username:e,surname:t}).then(function(e){n.verified.profile=e})}},{key:"signup",value:function(e){var t={409:function(e){return e.json().then(function(e){return Promise.resolve({exists:!0,token:e.token})})}};return this.post("signup",{username:e.username,email:e.email,recaptcha:e.recaptcha},t).then(function(e){return e.exists?e:{exists:!1,profile:e}})}},{key:"requestEmail",value:function(e){return this.post("resendEmail",e)}},{key:"unsubscribe",value:function(){var e=this;return this.post("unsubscribe",{key:this.verified.profile.verificationKey}).then(function(){e.verified.verified=!1,e.verified.profile})}},{key:"hasRole",value:function(e){return!!this.verified&&(!e||this.verified.profile.roles.some(function(t){return t===e}))}},{key:"checkUser",value:function(e){return this.verified&&this.verified.verified&&this.verified.profile&&this.verified.profile.verificationKey===e}},{key:"verify",value:function(e,t){var n=this;return this.checkUser(e)&&this.hasRole(t)?Promise.resolve(this.verified):this.get("verify?key="+e).then(function(e){return n.verified={verified:!0,profile:e},n.verified})}},{key:"turnout",value:function(){return this.get("turnout?key="+this.verified.profile.verificationKey).then(function(e){return e.result})}},{key:"rollUsers",value:function(){return this.post("rollUsers",{key:this.verified.profile.verificationKey})}},{key:"sendBeginWeekEmail",value:function(){return this.post("sendBeginWeekEmail",{key:this.verified.profile.verificationKey})}},{key:"sendReminderEmail",value:function(){return this.post("sendReminderEmail",{key:this.verified.profile.verificationKey})}},{key:"sendFinalEmail",value:function(){return this.post("sendFinalEmail",{key:this.verified.profile.verificationKey})}},{key:"sendCustomEmail",value:function(e,t){return this.post("sendCustomEmail",{key:this.verified.profile.verificationKey,text:e,allUsers:t})}}],[{key:"doFetch",value:function(e,t,n){var r=new Headers;switch(r.append("Content-Type","application/json"),e){case"GET":return fetch("/api/"+t,{method:"GET"});case"POST":return fetch("/api/"+t,{method:"POST",body:JSON.stringify(n),headers:r});default:throw"Unknown method: "+e}}}]),e}(),a=Object(y.a)(r.prototype,"error",[b.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),i=Object(y.a)(r.prototype,"errorText",[b.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),o=Object(y.a)(r.prototype,"busy",[b.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),s=Object(y.a)(r.prototype,"verified",[b.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{verified:!1}}}),Object(y.a)(r.prototype,"setError",[b.c],Object.getOwnPropertyDescriptor(r.prototype,"setError"),r.prototype),Object(y.a)(r.prototype,"clearError",[b.c],Object.getOwnPropertyDescriptor(r.prototype,"clearError"),r.prototype),Object(y.a)(r.prototype,"storeOption",[b.c],Object.getOwnPropertyDescriptor(r.prototype,"storeOption"),r.prototype),Object(y.a)(r.prototype,"storeTimeOption",[b.c],Object.getOwnPropertyDescriptor(r.prototype,"storeTimeOption"),r.prototype),Object(y.a)(r.prototype,"storeHoliday",[b.c],Object.getOwnPropertyDescriptor(r.prototype,"storeHoliday"),r.prototype),Object(y.a)(r.prototype,"storeFriends",[b.c],Object.getOwnPropertyDescriptor(r.prototype,"storeFriends"),r.prototype),Object(y.a)(r.prototype,"storeUserDetails",[b.c],Object.getOwnPropertyDescriptor(r.prototype,"storeUserDetails"),r.prototype),Object(y.a)(r.prototype,"signup",[b.c],Object.getOwnPropertyDescriptor(r.prototype,"signup"),r.prototype),Object(y.a)(r.prototype,"requestEmail",[b.c],Object.getOwnPropertyDescriptor(r.prototype,"requestEmail"),r.prototype),Object(y.a)(r.prototype,"unsubscribe",[b.c],Object.getOwnPropertyDescriptor(r.prototype,"unsubscribe"),r.prototype),Object(y.a)(r.prototype,"verify",[b.c],Object.getOwnPropertyDescriptor(r.prototype,"verify"),r.prototype),Object(y.a)(r.prototype,"turnout",[b.c],Object.getOwnPropertyDescriptor(r.prototype,"turnout"),r.prototype),r),E=n(11),k=n(4),O=n(3),g=n(5),j=Object(E.b)("controller")(l=function(e){function t(){return Object(d.a)(this,t),Object(k.a)(this,Object(O.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return c.createElement("div",null,c.createElement("p",{className:"App-intro"},"Oh dear something went wrong!"),c.createElement("p",null,"You can try refreshing, otherwise please try again later."),c.createElement("p",null,"If you unsubscribed, links you were sent in email will no longer work. You should ",c.createElement(m.b,{to:"/"},"subscribe again"),"."),c.createElement("pre",null,this.props.controller.errorText))}}]),t}(c.Component))||l,w=n(14),N=n(8),C=n(74),S=function(e){function t(){var e,n;Object(d.a)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(k.a)(this,(e=Object(O.a)(t)).call.apply(e,[this].concat(a)))).state={username:"",email:"",surname:"",emailExists:!1},n}return Object(g.a)(t,e),Object(f.a)(t,[{key:"signUp",value:function(){var e=this;this.setState({emailExists:!1}),this.props.controller.signup({username:this.state.username,surname:this.state.surname,email:this.state.email,recaptcha:this.state.recaptcha}).then(function(t){if(!t.exists)return e.props.history.push("/welcome/"+t.profile.verificationKey);e.setState({emailExists:!0,emailResendToken:t.token})})}},{key:"resendEmail",value:function(){var e=this;this.setState({requestEmail:!0}),this.props.controller.requestEmail({email:this.state.email,token:this.state.emailResendToken}).then(function(){return e.props.history.push("/resentEmail")})}},{key:"updateUsername",value:function(e){this.setState({username:e.target.value})}},{key:"updateSurname",value:function(e){this.setState({surname:e.target.value})}},{key:"updateEmail",value:function(e){this.setState({emailExists:!1,email:e.target.value})}},{key:"verifyCallback",value:function(e){this.setState({recaptcha:e})}},{key:"render",value:function(){var e=this,t=this.updateUsername.bind(this),n=this.updateEmail.bind(this),r=this.resendEmail.bind(this),a=this.signUp.bind(this),i=this.verifyCallback.bind(this);return c.createElement("div",null,c.createElement("p",{className:"App-intro"},"Welcome to Kensal Rise Backgammon. The club meets every Thursday at The Island pub from 8.30pm."),c.createElement("p",null,"To register your interest please enter your name and email below. We send weekly reminder emails to members."),c.createElement("form",{className:"pure-form pure-form-stacked"},c.createElement("fieldset",null,c.createElement("legend",null,"Sign up to Kensal Rise Backgammon"),c.createElement("label",{htmlFor:"username"},"First Name"),c.createElement("input",{id:"username",type:"text",placeholder:"Enter your name",required:!0,onChange:t,value:this.state.username}),c.createElement("label",{htmlFor:"surname"},"Surname (optional)"),c.createElement("input",{id:"surname",type:"text",placeholder:"Surname or first initial",onChange:function(t){return e.updateSurname(t)},value:this.state.surname}),c.createElement("label",{htmlFor:"email"},"Email"),c.createElement("input",{id:"email",type:"email",placeholder:"Enter your email",onChange:n,value:this.state.email}),this.state.emailExists&&c.createElement("div",{className:"Error"},"This email is already registered. Enter a different email or\xa0",c.createElement("a",{href:"#",onClick:r},"request an email")," you can then use to manage your profile."),this.state.requestEmail||c.createElement("div",{className:"Recaptcha"},c.createElement(C,{render:"explicit",onloadCallback:function(e){},verifyCallback:i,sitekey:"6LeVoTMUAAAAAEsZ1Pr5kaTV-18vSfm1jsB04nbQ"})),c.createElement("button",{type:"button",className:"pure-button pure-button-primary",onClick:a,disabled:void 0==this.state.email||void 0==this.state.recaptcha},this.props.controller.busy&&c.createElement(N.ScaleLoader,{color:"white",height:12,loading:!0}),this.props.controller.busy||c.createElement("span",null,"Sign Up!")))))}}]),t}(c.Component),A=Object(E.b)("controller")(Object(w.d)(S)),T=function(e){function t(){return Object(d.a)(this,t),Object(k.a)(this,Object(O.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return c.createElement("div",null,c.createElement("p",{className:"App-intro"},"You've been subscribed to Kensal Rise Backgammon!"),c.createElement("p",null,"We've sent you a welcome email to the email address you provided. Use the link in the email to manage your settings or unsubscribe."),c.createElement("p",null,"Or go straight to your ",c.createElement(_,{verificationKey:this.props.match.params.key},"Profile")))}}]),t}(c.Component),F=function(e){function t(){var e,n;Object(d.a)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(k.a)(this,(e=Object(O.a)(t)).call.apply(e,[this].concat(a)))).state={busy:!1},n}return Object(g.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){this.setState({friends:this.props.controller.verified.profile.friends})}},{key:"changeOption",value:function(e){this.setState({saved:!1,friends:e.target.value})}},{key:"storeFriends",value:function(e){var t=this;this.setState({saved:!1,busy:!0}),this.props.controller.storeFriends(e?void 0:this.state.friends).then(function(){t.setState({saved:!0,busy:!1})}).catch(function(){})}},{key:"clearFriends",value:function(){this.setState({friends:void 0}),this.storeFriends(!0)}},{key:"resetFriends",value:function(){this.setState({friends:this.props.controller.verified.profile.friends})}},{key:"render",value:function(){var e=this,t=this.props.controller.verified.profile;return c.createElement("form",{className:"pure-form App-standoff"},c.createElement("fieldset",null,c.createElement("legend",null,"Bringing a friend?"),c.createElement("div",null,"If you're planning to bring a friend or two along this week, tell us how many."),this.state.saved&&c.createElement("div",{className:"App-confirmsave"},c.createElement("span",null,"Your friend count was ",this.state.friends?"saved":"removed")),this.state.busy&&c.createElement("div",{className:"App-standoff"},c.createElement(N.ScaleLoader,{color:"blue",height:12,loading:!0}))||c.createElement("div",{className:"pure-control-group control-group-inline App-standoff"},"I'm planning to bring along \xa0",c.createElement("select",{value:this.state.friends,onChange:function(t){return e.changeOption(t)}},c.createElement("option",{hidden:void 0!=t.friends,selected:void 0===this.state.friends,value:void 0},"-"),[1,2,3,4,5].map(function(e){return c.createElement("option",{key:"option-"+e,value:e},e)})),c.createElement("span",{className:"App-selectlabel"},"friend(s)"),c.createElement("button",{type:"button",onClick:function(t){return e.storeFriends()},hidden:this.state.friends===t.friends,className:"pure-button pure-button-primary"},"Save"),c.createElement("button",{type:"button",onClick:function(t){return e.clearFriends()},hidden:void 0==t.friends||this.state.friends!==t.friends,className:"pure-button"},"Remove Friends"),c.createElement("button",{type:"button",onClick:function(t){return e.resetFriends()},hidden:this.state.friends===t.friends,className:"pure-button"},"Cancel"))))}}]),t}(c.Component),U=Object(E.c)(u=function(e){function t(){var e,n;Object(d.a)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(k.a)(this,(e=Object(O.a)(t)).call.apply(e,[this].concat(a)))).state={confirmed:!1},n}return Object(g.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.option;this.props.controller.storeOption(t).then(function(){e.setState({confirmed:!0})}).catch()}},{key:"render",value:function(){var e=this.props.match.params.option,t=this.props.controller.verified.profile;return e&&!this.state.confirmed?c.createElement("div",null,c.createElement("p",{className:"App-intro"},"Hold tight ",t.username,", storing your selection!"),c.createElement(N.ScaleLoader,{color:"blue",height:12,loading:!0})):c.createElement("section",null,c.createElement("p",{className:"App-intro"},"yes"===e&&c.createElement("span",null,"You've confirmed you will come this week!"),"no"===e&&c.createElement("span",null,"Sorry you can't make it this week!")),"yes"==e&&c.createElement(F,{controller:this.props.controller}),c.createElement("p",null,c.createElement(m.b,{className:"pure-button pure-button-primary",to:"/confirmed/"+this.props.match.params.key},"See who else is coming")))}}]),t}(c.Component))||u,R=n(37);function x(e,t){return Object(E.b)("controller")(Object(w.d)(function(n){function r(){var e,t;Object(d.a)(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(t=Object(k.a)(this,(e=Object(O.a)(r)).call.apply(e,[this].concat(a)))).state={verified:!1},t}return Object(g.a)(r,n),Object(f.a)(r,[{key:"componentDidMount",value:function(){var e=this;this.props.controller.verify(this.props.match.params.key,t).then(function(t){e.setState(t)})}},{key:"render",value:function(){var t=this.props,n=(t.name,Object(R.a)(t,["name"])),r="withHoc(".concat(e.displayName||e.name,")");return this.state.verified?c.createElement(e,Object.assign({name:r},n)):c.createElement("div",null,c.createElement("p",{className:"App-intro"},"Fetching your details"),c.createElement(N.ScaleLoader,{color:"blue",height:12,loading:!0}))}}]),r}(c.Component)))}var D,P,K=n(35),I=function(e){function t(){return Object(d.a)(this,t),Object(k.a)(this,Object(O.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this,t=this.props.items.filter(function(t){return t.option==e.props.option}).reduce(function(e,t){var n="yes"===t.option&&t.friends||0;return Number(e+1)+Number(n)},0);return c.createElement("span",null,function(e){return e>1?"are "+e+" people":0==e?"are no people":"is one person"}(t))}}]),t}(c.Component),H=function(e){function t(){var e,n;Object(d.a)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(k.a)(this,(e=Object(O.a)(t)).call.apply(e,[this].concat(a)))).state={},n}return Object(g.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.controller.turnout().then(function(t){return e.setState({turnout:t,ready:!0})})}},{key:"renderGroup",value:function(e){return this.state.turnout.filter(function(t){return t.option===e}).map(function(t,n){return c.createElement("div",{className:"App-userbadge",key:e+"-"+n},Object(K.userFriendlyName)(t),t.friends&&"yes"===t.option&&c.createElement("span",null," + ",t.friends))})}},{key:"render",value:function(){return this.state.ready&&c.createElement("div",null,c.createElement("p",{className:"App-intro"},"Current responses for this week"),c.createElement("p",null,"Regular start time is 8.30pm"),c.createElement("form",{className:"pure-form pure-form-stacked"},c.createElement("fieldset",null,c.createElement("legend",null,"There ",c.createElement(I,{items:this.state.turnout,option:"yes"})," confirmed"),this.renderGroup("yes")),c.createElement("fieldset",null,c.createElement("legend",null,"There ",c.createElement(I,{items:this.state.turnout,option:"no"})," who cannot make it"),this.renderGroup("no"))),c.createElement("p",null,"There are currently ",this.state.turnout.length," people on the email list."),c.createElement("p",null,"If you need to update your status for this week, view your ",c.createElement(_,{verificationKey:this.props.match.params.key},"Profile"),"."))||c.createElement("div",null,c.createElement("p",{className:"App-intro"},"Fetching information for this week"),c.createElement(N.ScaleLoader,{color:"blue",height:12,loading:!0}))}}]),t}(c.Component),B=function(e){function t(){return Object(d.a)(this,t),Object(k.a)(this,Object(O.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return c.createElement("div",null,c.createElement("p",{className:"App-intro"},"A welcome email has been re-sent to your email address."),c.createElement("p",null,"Use the link in the email to manage your profile."))}}]),t}(c.Component),Y=function(e){function t(){var e,n;Object(d.a)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(k.a)(this,(e=Object(O.a)(t)).call.apply(e,[this].concat(a)))).state={unsubscribeConfirmation:!1,busy:!1},n}return Object(g.a)(t,e),Object(f.a)(t,[{key:"unsubscribePrelim",value:function(){this.setState({unsubscribeConfirmation:!0})}},{key:"unsubscribeCancel",value:function(){this.setState({unsubscribeConfirmation:!1})}},{key:"unsubscribeProper",value:function(){var e=this;this.props.controller.unsubscribe().then(function(){return e.setState({busy:!1,unsubscribeConfirmation:!1}),e.props.history.push("/unsubscribed")})}},{key:"render",value:function(){var e=this.unsubscribePrelim.bind(this),t=this.unsubscribeProper.bind(this),n=this.unsubscribeCancel.bind(this);return c.createElement("form",{className:"pure-form App-standoff-large"},c.createElement("fieldset",null,c.createElement("legend",null,"... this is getting a bit much"),this.state.busy&&c.createElement("div",{className:"App-standoff"},c.createElement(N.ScaleLoader,{color:"blue",height:12,loading:!0}))||c.createElement("div",null,c.createElement("div",null,"If you no longer want to receive club emails, click the button below. You won't receive the weekly emails but you can still play if you want, and you can subscribe again at any time!"),this.state.unsubscribeConfirmation&&c.createElement("div",{className:"App-standoff"},"Are you sure you want to unsubscribe?",c.createElement("div",{className:"pure-control-group"},c.createElement("button",{type:"button",className:"pure-button pure-button-primary",onClick:t},c.createElement("span",null,"Confirm")),c.createElement("button",{type:"button",className:"pure-button",onClick:n},"Cancel"))),this.state.unsubscribeConfirmation||c.createElement("div",{className:"pure-control-group"},c.createElement("button",{type:"button",className:"pure-button pure-button-primary",onClick:e},c.createElement("span",null,"Unsubscribe"))))))}}]),t}(c.Component),L=function(e){function t(){var e,n;Object(d.a)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(k.a)(this,(e=Object(O.a)(t)).call.apply(e,[this].concat(a)))).state={unsubscribeConfirmation:!1,optionChanged:!1,busy:!1},n}return Object(g.a)(t,e),Object(f.a)(t,[{key:"setOption",value:function(e){var t=this;this.setState({optionChanged:!1,busy:!0}),this.props.controller.storeOption(e).then(function(){t.setState({optionChanged:!0,busy:!1})})}},{key:"setOptionYes",value:function(){this.setOption("yes")}},{key:"setOptionNo",value:function(){this.setOption("no")}},{key:"render",value:function(){var e=this.setOptionYes.bind(this),t=this.setOptionNo.bind(this),n=this.props.controller.verified.profile.option;return c.createElement("div",null,c.createElement("form",{className:"pure-form"},c.createElement("fieldset",null,"yes"===n&&c.createElement("legend",null,"You've said you're coming this week!"),"no"===n&&c.createElement("legend",null,"You've said you're not coming this week."),void 0===n&&c.createElement("legend",null,"You haven't let us know this week..."),this.state.busy&&c.createElement("div",{className:"App-standoff"},c.createElement(N.ScaleLoader,{color:"blue",height:12,loading:!0}))||c.createElement("div",{className:"pure-control-group"},c.createElement("button",{type:"button",hidden:"yes"===n,onClick:e,className:"pure-button pure-button-primary"},"I'll be there"),c.createElement("button",{type:"button",hidden:"no"===n,onClick:t,className:"pure-button pure-button-primary"},"I can't come"),"\xa0"))))}}]),t}(c.Component),W=function(e){function t(){var e,n;Object(d.a)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(k.a)(this,(e=Object(O.a)(t)).call.apply(e,[this].concat(a)))).state={busy:!1},n}return Object(g.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){this.setState({holiday:this.props.controller.verified.profile.holiday})}},{key:"changeOption",value:function(e){this.setState({saved:!1,holiday:e.target.value})}},{key:"storeHoliday",value:function(e){var t=this;this.setState({saved:!1,busy:!0}),this.props.controller.storeHoliday(e?void 0:this.state.holiday).then(function(){t.setState({saved:!0,busy:!1})}).catch(function(){})}},{key:"clearHoliday",value:function(){this.setState({holiday:void 0}),this.storeHoliday(!0)}},{key:"resetHoliday",value:function(){this.setState({holiday:this.props.controller.verified.profile.holiday})}},{key:"render",value:function(){var e=this,t=this.props.controller.verified.profile;return c.createElement("form",{className:"pure-form App-standoff"},c.createElement("fieldset",null,c.createElement("legend",null,"Take a break from emails"),c.createElement("div",null,"If you're going on holiday or know you can't come for a while, opt out of the weekly emails."),this.state.saved&&c.createElement("div",{className:"App-confirmsave"},c.createElement("span",null,"Your email opt out was ",this.state.holiday?"saved":"removed")),this.state.busy&&c.createElement("div",{className:"App-standoff"},c.createElement(N.ScaleLoader,{color:"blue",height:12,loading:!0}))||c.createElement("div",{className:"pure-control-group control-group-inline"},c.createElement("select",{value:this.state.holiday,onChange:function(t){return e.changeOption(t)}},c.createElement("option",{hidden:void 0!=t.holiday,selected:void 0===this.state.holiday,value:void 0},"-"),[1,2,3,4,5,6,7,8,9,10].map(function(e){return c.createElement("option",{key:"option-"+e,value:e},e)})),c.createElement("span",{className:"App-selectlabel"},"Weeks"),c.createElement("button",{type:"button",onClick:function(t){return e.storeHoliday()},hidden:this.state.holiday===t.holiday,className:"pure-button pure-button-primary"},"Save"),c.createElement("button",{type:"button",onClick:function(t){return e.clearHoliday()},hidden:void 0==t.holiday||this.state.holiday!==t.holiday,className:"pure-button"},"Remove Opt Out"),c.createElement("button",{type:"button",onClick:function(t){return e.resetHoliday()},hidden:this.state.holiday===t.holiday,className:"pure-button"},"Cancel"))))}}]),t}(c.Component),q=n(36),M=n(22),G=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(k.a)(this,Object(O.a)(t).call(this,e))).state={busy:!1,username:"",surname:"",saved:!1},n.updateInput=n.updateInput.bind(Object(M.a)(Object(M.a)(n))),n}return Object(g.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){this.updateStateFromController()}},{key:"updateStateFromController",value:function(){this.setState({busy:!1,username:this.profile.username,surname:this.profile.surname})}},{key:"updateInput",value:function(e){this.setState(Object(q.a)({saved:!1},e.target.name,e.target.value))}},{key:"storeDetails",value:function(){var e=this;this.setState({saved:!1,busy:!0}),this.props.controller.storeUserDetails(this.state.username,this.state.surname).then(function(){e.setState({saved:!0,busy:!1}),e.updateStateFromController()}).catch(function(){})}},{key:"resetDetails",value:function(){this.setState({username:this.profile.username,surname:this.profile.surname})}},{key:"render",value:function(){var e=this;return c.createElement("form",{className:"pure-form pure-form-stacked"},c.createElement("fieldset",null,c.createElement("legend",null,"Change your details"),this.state.saved&&c.createElement("div",{className:"App-confirmsave"},c.createElement("span",null,"Your details were saved")),this.state.busy&&c.createElement("div",{className:"App-standoff"},c.createElement(N.ScaleLoader,{color:"blue",height:12,loading:!0}))||c.createElement("div",null,c.createElement("div",{className:"pure-g"},c.createElement("div",{className:"pure-u-1 pure-u-sm-1-2"},c.createElement("label",{htmlFor:"username"},"First Name"),c.createElement("input",{name:"username",id:"username",type:"text",placeholder:"Enter your name",required:!0,onChange:this.updateInput,value:this.state.username})),c.createElement("div",{className:"pure-u-1 pure-u-sm-1-2"},c.createElement("label",{htmlFor:"surname"},"Surname (optional)"),c.createElement("input",{name:"surname",id:"surname",type:"text",placeholder:"Surname or initial",onChange:this.updateInput,value:this.state.surname||""}))),c.createElement("button",{type:"button",onClick:function(t){return e.storeDetails()},hidden:this.pristine,className:"pure-button pure-button-primary"},"Save"),c.createElement("button",{type:"button",onClick:function(t){return e.resetDetails()},hidden:this.pristine,className:"pure-button"},"Cancel"))))}},{key:"profile",get:function(){return this.props.controller.verified.profile}},{key:"pristine",get:function(){return this.state.username===this.profile.username&&this.state.surname===this.profile.surname}}]),t}(c.Component),z=Object(E.c)(D=function(e){function t(){return Object(d.a)(this,t),Object(k.a)(this,Object(O.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.props.controller,t=e.verified.profile,n=t.username,r=t.option;return c.createElement("div",null,c.createElement("p",{className:"App-intro"},"Hello ",n,", this is your Kensal Rise Backgammon profile"),c.createElement("p",null,"The club meets Thursdays at The Island pub in Kensal Rise. Regular start time is 8.30pm."),c.createElement("div",null,c.createElement(L,{controller:e}),"yes"==r&&c.createElement(F,{controller:e}),c.createElement("form",{className:"pure-form App-standoff"},c.createElement("fieldset",null,c.createElement("legend",null,"Want to know who's coming?"),c.createElement(m.b,{className:"pure-button pure-button-primary",to:"/confirmed/"+this.props.match.params.key},"Show me"))),c.createElement(W,{controller:e}),c.createElement(G,{controller:e}),e.verified.profile.roles.some(function(e){return"admin"===e})&&c.createElement("div",null,c.createElement("form",{className:"pure-form App-standoff"},c.createElement("p",null),c.createElement("fieldset",null,c.createElement("legend",null,"Looks like you're an admin"),c.createElement(m.b,{className:"pure-button pure-button-primary",to:"/admin/"+e.verified.profile.verificationKey},"Go to Admin")))),c.createElement(Y,{controller:e,history:this.props.history})))}}]),t}(c.Component))||D,J=function(e){function t(){return Object(d.a)(this,t),Object(k.a)(this,Object(O.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return c.createElement("div",null,c.createElement("p",{className:"App-intro"},"You've been unsubscribed"),c.createElement("p",null,"You'll no longer receive emails from us."),c.createElement("p",null,"If you want to subscribe again at any point just ",c.createElement(m.b,{to:"/"},"use the form on our homepage"),"."),c.createElement("p",null,"Note that if you bookmarked your profile page or added it to your homescreen, these links will no longer work."))}}]),t}(c.Component),V=Object(E.c)(P=function(e){function t(){var e,n;Object(d.a)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(k.a)(this,(e=Object(O.a)(t)).call.apply(e,[this].concat(a)))).state={emailText:"",allUsers:!1},n}return Object(g.a)(t,e),Object(f.a)(t,[{key:"sendRollUsers",value:function(){return this.props.controller.rollUsers()}},{key:"sendBeginWeekEmail",value:function(){return this.props.controller.sendBeginWeekEmail()}},{key:"sendReminderEmail",value:function(){return this.props.controller.sendReminderEmail()}},{key:"sendFinalEmail",value:function(){return this.props.controller.sendFinalEmail()}},{key:"handleEmailTextChange",value:function(e){this.setState({emailText:e.target.value})}},{key:"updateAllUsersFlag",value:function(){this.setState({allUsers:!this.state.allUsers})}},{key:"sendCustomEmail",value:function(){return this.props.controller.sendCustomEmail(this.state.emailText,this.state.allUsers)}},{key:"render",value:function(){var e=this,t=this.sendBeginWeekEmail.bind(this),n=this.sendReminderEmail.bind(this),r=this.sendFinalEmail.bind(this);return c.createElement("div",null,c.createElement("p",{className:"App-intro"},"Welcome to admin"),c.createElement("form",{className:"pure-form pure-form-stacked"},c.createElement("fieldset",null,c.createElement("legend",null,"Send a message to all subscribers (not formatted)"),c.createElement("textarea",{className:"App-email-message",value:this.state.emailText,onChange:function(t){return e.handleEmailTextChange(t)},rows:10}),this.props.controller.busy||c.createElement("div",{className:"pure-control-group"},c.createElement("button",{type:"button",onClick:function(){return e.sendCustomEmail()},className:"pure-button pure-button-primary"},"Send"),c.createElement("input",{type:"checkbox",name:"allUsers",onClick:function(){return e.updateAllUsersFlag()},checked:this.state.allUsers})," Include opted out users")),c.createElement("fieldset",null,c.createElement("legend",null,"Manually send weekly emails"),this.props.controller.busy&&c.createElement(N.ScaleLoader,{color:"blue",height:12,loading:!0})||c.createElement("div",{className:"pure-control-group App-evenbuttons"},c.createElement("button",{type:"button",onClick:function(){return e.sendRollUsers()},className:"pure-button pure-button-primary"},"Roll Users"),c.createElement("button",{type:"button",onClick:t,className:"pure-button pure-button-primary"},"Begin Week"),c.createElement("button",{type:"button",onClick:n,className:"pure-button pure-button-primary"},"Reminder"),c.createElement("button",{type:"button",onClick:r,className:"pure-button pure-button-primary"},"Final")))),c.createElement("p",null,c.createElement(_,{verificationKey:this.props.controller.verified.profile.verificationKey},"Back to safety...")))}}]),t}(c.Component))||P,_=function(e){function t(){return Object(d.a)(this,t),Object(k.a)(this,Object(O.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return c.createElement(m.b,{to:"/profile/"+this.props.verificationKey},this.props.children)}}]),t}(c.Component),Q=function(e){function t(){return Object(d.a)(this,t),Object(k.a)(this,Object(O.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return this.props.controller.error?(console.log("CONTROLLER IN ERROR - SHOW ERROR DISPLAY"),c.createElement(j,null)):c.createElement("div",null,c.createElement(w.a,{exact:!0,path:"/",component:A}),c.createElement(w.a,{path:"/admin/:key",component:x(V)}),c.createElement(w.a,{path:"/resentEmail",component:B}),c.createElement(w.a,{path:"/welcome/:key",component:x(T)}),c.createElement(w.a,{path:"/profile/:key",component:x(z)}),c.createElement(w.a,{path:"/status/:key/:option",component:x(U)}),c.createElement(w.a,{path:"/confirmed/:key",component:x(H)}),c.createElement(w.a,{path:"/unsubscribed",component:J}))}}]),t}(c.Component),Z=Object(E.b)("controller")(Object(w.d)(Object(E.c)(Q)));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(75),n(77),n(79),n(81);var $=function(e){function t(){return Object(d.a)(this,t),Object(k.a)(this,Object(O.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return c.createElement("div",{className:"App"},c.createElement("div",{className:"pure-g"},c.createElement("div",{className:"pure-u-1 pure-u-md-1-5"}),c.createElement("div",{className:"pure-u-1 pure-u-md-3-5"},c.createElement("div",{className:"BodyContent"},this.props.children)),c.createElement("div",{className:"pure-u-1 pure-u-md-1-5"})))}}]),t}(c.Component),X=new v;p.render(c.createElement(E.a,{controller:X},c.createElement(m.a,null,c.createElement("div",null,c.createElement($,null,c.createElement(Z,null))))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[38,2,1]]]);